require(XLConnect)
require(rjava)
for (root in c("HLM", "HCU")) for (key in c("Software\\JavaSoft\\Java Runtime Environment",
"Software\\JavaSoft\\Java Development Kit")) {
hive <- try(utils::readRegistry(key, root, 2),
silent = TRUE)
if (!inherits(hive, "try-error"))
return(hive)
}
hive
Sys.setenv(JAVA_HOME='C:\\Program Files\\Java\\jdk1.7.0_12')
require(rjava)
require(XLConnect)
Sys.setenv(JAVA_HOME='C:\\Program Files\\Java\\jre7')
require(rjava)
require(XLConnect)
hive
Sys.setenv(JAVA_HOME="C:\\Program Files\\Java\\jdk1.7.0_12")
require(rjava)
require(XLConnect)
Sys.setenv(JAVA_HOME="C:\\Program Files\\Java\\jre7")
require(rjava)
Sys.setenv(JAVA_HOME="C:\\Program Files\\Java\\jdk1.7.0_12")
require(rJava)
require(XLConnect)
Sys.setenv(JAVA_HOME="C:\\Program Files\\Java\\jre7")
require(rJava)
require(XLConnect)
Sys.setenv(JAVA_HOME="C:\\Program Files\\Java\\jdk1.7.0_12")
require(rJava)
require(XLConnect)
require(rJava)
require(XLConnect)
?XLConnect
wb <- loadWorkbook("XLConnect.xlsx", create = TRUE)
# Create a worksheet
createSheet(wb, name = "mtcars")
# Create a name reference
createName(wb, name = "mtcars", formula = "mtcars!$C$5")
# Write built-in data.frame 'mtcars' to the specified named region
writeNamedRegion(wb, mtcars, name = "mtcars")
# Save workbook
saveWorkbook(wb)
wb <- loadWorkbook("XLConnect.xlsx", create = TRUE)
wb
# Create a worksheet
createSheet(wb, name = "mtcars")
# Create a name reference
createName(wb, name = "mtcars", formula = "mtcars!$C$5")
# Write built-in data.frame 'mtcars' to the specified named region
writeNamedRegion(wb, mtcars, name = "mtcars")
# Save workbook
saveWorkbook(wb)
# Load workbook; create if not existing
wb <- loadWorkbook("XLConnect.xlsx", create = TRUE)
# Create a worksheet
createSheet(wb, name = "mtcars")
# Create a name reference
createName(wb, name = "mtcars", formula = "mtcars!$A$1")
# Write built-in data.frame 'mtcars' to the specified named region
writeNamedRegion(wb, mtcars, name = "mtcars")
# Save workbook
saveWorkbook(wb)
mtcars
demoExcelFile <- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")
demoExcelFile
# Load workbook
wb <- loadWorkbook(demoExcelFile)
wb
# Read named region 'mtcars' (with default header = TRUE)
data <- readNamedRegion(wb, name = "mtcars")
data
## Example 2;
# conversion xlsx file from demoFiles subfolder of package XLConnect
excelFile <- system.file("demoFiles/conversion.xlsx", package = "XLConnect")
excelFile
# Load workbook
wb <- loadWorkbook(excelFile)
wb
# Read named region 'conversion' with pre-specified column types
# Note: in the worksheet all data was entered as strings!
# forceConversion = TRUE is used to force conversion from String
# into the less generic data types Numeric, DateTime & Boolean
df <- readNamedRegion(wb, name = "conversion", header = TRUE,
colTypes = c(XLC$DATA_TYPE.NUMERIC,
XLC$DATA_TYPE.DATETIME,
XLC$DATA_TYPE.BOOLEAN),
forceConversion = TRUE,
dateTimeFormat = "%Y-%m-%d %H:%M:%S")
df
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile <- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")
# Load workbook
wb <- loadWorkbook(demoExcelFile)
# Read the columns 1, 3 and 5 of the named region 'mtcars' (with default header = TRUE)
data <- readNamedRegion(wb, name = "mtcars", keep=c(1,3,5))
data
setwd("F:/DataW/seeds")
setwd("F:/DataW/seeds")
setwd("F:/GitHub/ceshiR")
dir()
setwd("F:/GitHub/ceshiR/aaa")
dir()
dir()
setwd("F:/DataW/seeds")
dir()
setwd("F:/DataW/seeds/dataseed")
dir()
dir("F:/DataW/seeds/dataseed")
setwd("F:/GitHub/ceshiR/aaa")
dd <- dir("F:/DataW/seeds/dataseed")
dd
wb <- loadWorkbook(dd[1])
demoExcelFile <- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")
demoExcelFile
system.file("demoFiles/mtcars.xlsx", package = "XLConnect")
system.file(dd[1])
dd[1]
system.file(dd[1])
list.files(dd[1])
file.path(dd[1])
setwd(getScriptPath())
getScriptPath()
getwd(dd[1])
dd[1]
getwd()
search()
search(dd[1])
da <-dd[1]
search(da)
system.file("demoFiles/mtcars.xlsx", package = "XLConnect")
fil1 <-"F:/DataW/seeds/dataseed"
dd <- dir(fil1)
dd
file.path(fil1,fsep=da)
da <-dd[1]
da
file.path(fil1,fsep=da)
.Platform$path.sep.
.Platform
paste(fil1, da)
paste(fil1, da,sep='/')
demoEF0 <- paste(fil1, da,sep='/')
wb <- loadWorkbook(demoEF0)
wb
data <- readNamedRegion(wb, name = "mb")
wb <- loadWorkbook(demoEF0)
data <- readNamedRegion(wb, name = "mb")
data <- readNamedRegion(wb, name = "mtcars")
data <- readNamedRegion(wb)
data <- readNamedRegion(wb, name=1)
data <- readNamedRegion(wb, name='')
data <- readNamedRegion(wb, name='Sheet2')
wb <- loadWorkbook(demoEF0)
data <- readNamedRegion(wb, name='Sheet2')
data <- readNamedRegion(wb, name="Sheet2")
data <- readNamedRegion(wb, name="Sheet1")
wb <- loadWorkbook(demoEF0)
data <- readNamedRegion(wb, name="Sheet1")
loadWorkbook(demoEF0)
loadWorkbook("XLConnect.xlsx", create = TRUE)
demoExcelFile
demoEF0
loadWorkbook(demoExcelFile)
loadWorkbook(demoEF0)
demoEF0
readNamedRegion(wb, name = "mtcars")
r
wb <- loadWorkbook(demoExcelFile)
readNamedRegion(wb, name = "mtcars")
wb <- loadWorkbook(demoEF0)
readNamedRegion(wb, name="sheet1")
readNamedRegion(wb, name = "sheet1")
dd[1]
dd[2]
dd <- dir(fil1)
dd[2]
dd[1]
dir(fil1)
da
dd[1]
demoEF0 <- paste(fil1, da,sep='/')
demoEF0
da <- dd[1]
demoEF0 <- paste(fil1, da,sep='/')
demoEF0
loadWorkbook(demoEF0)
fil1 <-"F:/DataW/seeds/dataseed"
dd <- dir(fil1)
da <- dd[1]
dd[1]
demoEF0 <- paste(fil1, da,sep='/')
wb <- loadWorkbook(demoEF0)
data <- readNamedRegion(wb, name = "sheet1")
data <- readNamedRegion(wb, name = "Sheet1")
loadWorkbook("XLConnect.xlsx", create = TRUE)
# Create a worksheet
createSheet(wb, name = "mtcars")
# Create a name reference
createName(wb, name = "mtcars", formula = "mtcars!$A$1")
# Write built-in data.frame 'mtcars' to the specified named region
writeNamedRegion(wb, mtcars, name = "mtcars")
# Save workbook
saveWorkbook(wb)
dir(fil0)
fil0 <- "F:/GitHub/ceshiR/aaa"
dir(fil0)
dd <- dir(fil0)
da <- dd[1]
demoEF0 <- paste(fil1, da,sep='/')
wb <- loadWorkbook(demoEF0)
demoEF0 <- paste(fil0, da,sep='/')
wb <- loadWorkbook(demoEF0)
paste(fil0, da,sep='/')
fil0 <- "F:/GitHub/ceshiR/aaa"
dd <- dir(fil0)
dd
dd <- dir(fil0,'xlsx')
dd
da <- dd[1]
demoEF0 <- paste(fil0, da,sep='/')
demoEF0
wb <- loadWorkbook(demoEF0)
data <- readNamedRegion(wb, name = "mtcars")
data
dd <- dir(fil0,'xls')
fil1 <-"F:/DataW/seeds/dataseed"
dd <- dir(fil1)
da <- dd[1]
demoEF0 <- paste(fil0, da,sep='/')
wb <- loadWorkbook(demoEF0)
fil0 <- "F:/GitHub/ceshiR/aaa"
setwd(fil0)
dd <- dir(fil0,'xls')
da <- dd[1]
demoEF0 <- paste(fil0, da,sep='/')
wb <- loadWorkbook(demoEF0)
data <- readNamedRegion(wb, name = "mtcars")
dir(fil1)
dir(fil0,'xls')
dd <- dir(fil0,'xls')
dir(fil0,'xls')
demoEF0 <- paste(fil0, dd[1],sep='/')
wb <- loadWorkbook(demoEF0)
data <- readNamedRegion(wb, name = "mtcars")
data
fil0 <- "F:/GitHub/ceshiR/aaa"
setwd(fil0)
dd <- dir(fil0,'xls')
dir(fil0,'xls')
demoEF0 <- paste(fil0, dd[1],sep='/')
wb <- loadWorkbook(demoEF0)
data <- readNamedRegion(wb, name = "mtcars")
demoExcelFile <- system.file("demoFiles/multiregion.xlsx",
package = "XLConnect")
# Load a single named region into a single data.frame.
df <- readNamedRegionFromFile(demoExcelFile, name="Iris")
df
readNamedRegionFromFile(demoExcelFile,
name=c("Calendar", "Iris", "IQ"))
fil0 <- "F:/GitHub/ceshiR/aaa"
setwd(fil0)
dd <- dir(fil0,'xls')
dd
demoEF0 <- paste(fil0, dd[2],sep='/')
wb <- loadWorkbook(demoEF0)
data <- readNamedRegion(wb, name = "Sheet1")
readNamedRegion(wb, name = "Sheet1")
vignette ( " XLConnect ")
vignette ( "XLConnect")
require(XLConnect)
wb = loadWorkbook("XLConnectExample1.xlsx", create = TRUE)
loadWorkbook("XLConnectExample1.xlsx", create = TRUE)
data = readWorksheet(wb, sheet = "chickSheet", startRow = 0, endRow = 10,
+ startCol = 0, endCol = 0)
data = readWorksheet(wb, sheet = "chickSheet", startRow = 0, endRow = 10,
+ startCol = 0, endCol = 0)
startCol = 0, endCol = 0)
wb = loadWorkbook("XLConnectExample1.xlsx", create = TRUE)
data = readWorksheet(wb, sheet = "chickSheet", startRow = 0, endRow = 10,
startCol = 0, endCol = 0)
data
data = readWorksheet(wb, sheet = "chickSheet", startRow = 0, endRow = 10,
startCol = 0, endCol = 0)
hive
for (root in c("HLM", "HCU"))
for (key in c("Software\\JavaSoft\\Java Runtime Environment"
, "Software\\JavaSoft\\Java Development Kit")) {
hive <- try(utils::readRegistry(key, root, 2),
silent = TRUE)
if (!inherits(hive, "try-error"))
return(hive)
}
hive
Sys.setenv(JAVA_HOME="C:\\Program Files\\Java\\jre7")
require(rJava)
require(XLConnect)
wb = loadWorkbook("XLConnectExample1.xlsx", create = TRUE)
data = readWorksheet(wb, sheet = "chickSheet", startRow = 0, endRow = 10,
startCol = 0, endCol = 0)
data
data = readWorksheet(wb, sheet = "chickSheet", startRow = 0, endRow = 10,
startCol = 0, endCol = 0)
data = readWorksheet(wb, sheet = "chickSheet", startRow = 0, endRow = 10,
startCol = 0, endCol = 10)
data
dd
loadWorkbook(dd[2])
data <- readNamedRegion(wb, name = "Sheet1")
data <- readNamedRegion(wb,"Sheet1")
readNamedRegionFromFile("XLConnectExample3.xlsx", "womenName")
readNamedRegionFromFile(wb, "Sheet1")
setwd(fil0)
dd <- dir(fil0,'xls')
dd
wb <- loadWorkbook(dd[2])
readNamedRegionFromFile(wb, "Sheet1")
path.expand(wb)
path.expand(dd)
wb
readNamedRegionFromFile(wb, "Sheet1")
paste(fil0, dd[2],sep='/')
loadWorkbook(demoEF0)
edit(file = system.file("XLConnect.R", package = "XLConnect"))
dd <- dir(fil0,'xls')
dd
demoEF0 <- paste(fil0, dd[5],sep='/')
wb <- loadWorkbook(demoEF0)
data <- readNamedRegion(wb, name = "Sheet1")
data <- readNamedRegion(wb, name = "aa")
data
dd <- dir(fil0,'xls') ; dd
demoEF0 <- paste(fil0, dd[5],sep='/')
wb <- loadWorkbook(demoEF0)
wb
readNamedRegion(wb,"mtcars")
wb <- loadWorkbook(demoEF0); wb
readNamedRegion(wb,"mtcars")
readNamedRegion(wb,name="mtcars")
demoEF0 <- paste(fil0, dd[5],sep='/')
wb <- loadWorkbook(demoEF0); wb
dd <- dir(fil0,'xls') ; dd
demoEF0 <- paste(fil0, dd[4],sep='/')
wb <- loadWorkbook(demoEF0); wb
readNamedRegion(wb,name="mtcars")
data <- readNamedRegion(wb, name = "aa")
wb <- loadWorkbook(demoEF0); wb
readNamedRegion(wb,name="mm")
fil0 <- "F:/GitHub/ceshiR/aaa"
setwd(fil0)
dd <- dir(fil0,'xls') ; dd
demoEF0 <- paste(fil0, dd[4],sep='/')
wb <- loadWorkbook(demoEF0); wb
readNamedRegion(wb,name="mm")
data <- readNamedRegion(wb, name = "aa")
demoEF0 <- paste(fil0, dd[4],sep='/')
wb <- loadWorkbook(demoEF0); wb
readNamedRegion(wb,name="mm")
readNamedRegion(wb,name="mtcars")
paste(fil0, dd[4],sep='/')
wb <- loadWorkbook(demoEF0); wb
readNamedRegion(wb,name="mtcars")
readNamedRegion(wb,name="mm")
data <- readNamedRegion(wb, name = "aa")
Sys.setenv(JAVA_HOME="C:\\Program Files\\Java\\jdk1.7.0_12")
require(rJava)
require(XLConnect)
fil0 <- "F:/GitHub/ceshiR/aaa"
setwd(fil0)
dd <- dir(fil0,'xls') ; dd
demoEF0 <- paste(fil0, dd[4],sep='/')
demoEF0 <- paste(fil0, dd[4],sep='/'); demoEF0
wb <- loadWorkbook(demoEF0); wb
readNamedRegion(wb,name="mtcars")
readNamedRegion(wb,name="mm")
data <- readNamedRegion(wb, name = "aa")
edit(file = system.file("XLConnect.R", package = "XLConnect"))
if( !file.exists( 'figs' ) ) dir.create( 'figs' )
require(tikzDevice)
require(XLConnect)
###################################################
if(file.exists("XLConnectExample1.xlsx"))
file.remove("XLConnectExample1.xlsx")
require(XLConnect)
wb <- loadWorkbook("XLConnectExample1.xlsx", create = TRUE)
createSheet(wb, name = "chickSheet")
writeWorksheet(wb, ChickWeight, sheet = "chickSheet", startRow = 3, startCol = 4)
saveWorkbook(wb)
wb <- loadWorkbook(demoEF0); wb
readWorksheetFromFile(wb, sheet=1, header=TRUE)
readWorksheetFromFile("F:/GitHub/ceshiR/aaa/XLConnect.xlsx", sheet=1, header=TRUE)
readWorksheetFromFile("F:/GitHub/ceshiR/aaa/XLConnect.xlsx", sheet=2, header=TRUE)
readWorksheetFromFile("F:/GitHub/ceshiR/aaa/XLConnect.xlsx", sheet=3, header=TRUE)
dd <- dir(fil0,'xls') ; dd
demoEF0 <- paste(fil0, dd[2],sep='/'); demoEF0
wb <- loadWorkbook(demoEF0); wb
readWorksheetFromFile("F:/GitHub/ceshiR/aaa/XLConnect.xlsx", sheet=3, header=TRUE)
wb
readWorksheetFromFile(file=wb #"F:/GitHub/ceshiR/aaa/XLConnect.xlsx"
, sheet=3, header=TRUE)
readWorksheetFromFile(file= "F:/GitHub/ceshiR/aaa/XLConnect.xlsx"
, sheet=3, header=TRUE)
readWorksheetFromFile(file= "F:/GitHub/ceshiR/aaa/aaa.xls"
, sheet=3, header=TRUE)
, sheet=2, header=TRUE)
readWorksheetFromFile(file= "F:/GitHub/ceshiR/aaa/aaa.xls"
, sheet=2, header=TRUE)
, sheet=1, header=TRUE)
readNamedRegion(wb,name="mtcars")
readWorksheetFromFile(file= "F:/GitHub/ceshiR/aaa/aaa.xls"
, sheet=1, header=TRUE)
loadWorkbook(demoEF0)
readWorksheetFromFile(loadWorkbook(demoEF0)#file= "F:/GitHub/ceshiR/aaa/aaa.xls"
, sheet=1, header=TRUE)
dir()
ss <- dir()[1]
xls <- loadWorkbook(ss,create=TRUE)
xls
data <- readWorksheet(xls, 1,
startRow=1, startCol=1,
endRow=0,endCol=0, #取0表示自动判断
header=TRUE)
data
data <- readWorksheet(xls, 2,
startRow=1, startCol=1,
endRow=0,endCol=0, #取0表示自动判断
header=TRUE)
data
data <- readWorksheet(ss, 2,
startRow=1, startCol=1,
endRow=0,endCol=0, #取0表示自动判断
header=TRUE)
loadWorkbook(ss,create=TRUE)
xls
data <- readWorksheet(xls, 2,
startRow=1, startCol=1,
endRow=0,endCol=0, #取0表示自动判断
header=TRUE)
data
demoExcelFile <- system.file("demoFiles/multiregion.xlsx",
package = "XLConnect")
demoExcelFile
df.one <- readWorksheetFromFile(demoExcelFile, sheet = 1,
header = FALSE, startCol = 2,
startRow = 2, endCol = 3,
endRow = 3)
df.one
df.one <- readWorksheetFromFile(ss, sheet = 1,
header = FALSE, startCol = 2,
startRow = 2, endCol = 3,
endRow = 3)
readWorksheetFromFile(ss, sheet = 1,
header = FALSE, startCol = 2,
startRow = 2, endCol = 3,
endRow = 3)
readWorksheetFromFile(ss, sheet = 2,
header = FALSE, startCol = 2,
startRow = 2, endCol = 3,
endRow = 3)
readWorksheetFromFile(ss, sheet = 2)
